dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
# saving
write_xlsx(dhs,"mada_dhs_97_assets_cleaned.xlsx")
rm(codebook, dhs)
### DHS 2008-2009
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",2) # 2nd sheet is 2008-2009
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2008_09/MDHR51FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables, then save
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
# saving
write_xlsx(dhs,"mada_dhs_200809_assets_cleaned.xlsx")
rm(codebook, dhs)
### DHS 2011
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",3) # 3rd sheet is 2011
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2011/MDHR61FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables, then save
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
# saving
write_xlsx(dhs,"mada_dhs_2011_assets_cleaned.xlsx")
rm(codebook, dhs)
### DHS 2013
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",4) # 4th sheet is 2013
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2013/MDHR6AFL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables, then save
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
# saving
write_xlsx(dhs,"mada_dhs_2013_assets_cleaned.xlsx")
rm(codebook, dhs)
### DHS 2016
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",5) # 5th sheet is 2016
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2016/MDHR71FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables, then save
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
# saving
write_xlsx(dhs,"mada_dhs_2016_assets_cleaned.xlsx")
rm(codebook, dhs)
# imputation for replacing missing values before PCA
# Merge with GPS coordinates
# PCA
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",1) # first sheet is 1997
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/1997/MDHR31FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables, then save
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
View(dhs)
View(dhs)
cor(dhs$urban_rural, dhs$electricity)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural=="urban", 1)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural=="rural", 0)
dhs$urban_rural <- as.numeric(dhs$urban_rural)
cor(dhs$urban_rural, dhs$electricity)
corr(dhs$urban_rural, dhs$electricity)
cor(dhs$urban_rural, dhs$electricity, na.rm = T)
cor(urban_rural, electricity)
cor(dhs$urban_rural, dhs$electricity)
table(dhs$urban_rural, dhs$electricity)
table(dhs$radio, dhs$electricity)
table(dhs$telephone, dhs$electricity)
table(dhs$tv, dhs$electricity)
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",2) # 2nd sheet is 2008-2009
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2008_09/MDHR51FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
View(dhs)
View(dhs)
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",2) # 2nd sheet is 2008-2009
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2008_09/MDHR51FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
View(dhs)
View(dhs)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
View(dhs)
View(dhs)
dhs[dhs==9]=NA
summary(dhs)
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",2) # 2nd sheet is 2008-2009
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2008_09/MDHR51FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",1) # first sheet is 1997
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/1997/MDHR31FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
table(dhs)
View(dhs)
View(dhs)
dhs[dhs==9]=NA
dhs[dhs==99]=NA
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",2) # 2nd sheet is 2008-2009
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2008_09/MDHR51FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
table(dhs)
summary(dhs)
View(dhs)
View(dhs)
dhs[dhs==9]=NA
dhs[dhs==99]=NA
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",2) # 2nd sheet is 2008-2009
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2008_09/MDHR51FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
View(dhs)
View(dhs)
View(codebook)
View(codebook)
table(dhs$hv213)
# load data
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",3) # 3rd sheet is 2011
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2011/MDHR61FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
summzry(dhs)
summary(dhs)
dhs[dhs==9]=NA
dhs[dhs==99]=NA
# imputation for replacing missing values before PCA
# Merge with GPS coordinates
# saving
write_xlsx(dhs,"mada_dhs_2011_assets_cleaned.xlsx")
rm(codebook, dhs)
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",3) # 3rd sheet is 2011
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2011/MDHR61FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
dhs[dhs==9]=NA
dhs[dhs==99]=NA
View(dhs)
View(dhs)
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",4) # 4th sheet is 2013
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2013/MDHR6AFL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
summary(dhs)
dhs[dhs==9]=NA
dhs[dhs==99]=NA
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",5) # 5th sheet is 2016
colnames(codebook) = codebook[1,] # top line is col. names
codebook <- codebook[-1,] # drop 1st line (repetition of colnames)
dhs <- data.frame(read.dta13("raw_data/Madagascar/2016/MDHR71FL.DTA", convert.factors = F))
# retrieve numeric codes for recoding the 3 qualitative variables: floor type, toilet type and drinking water source type
dhs <- merge(dhs, codebook[,c(1,3)], by.x = "hv205", by.y = "dhs_code_toilet", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(4,6)], by.x = "hv201", by.y = "dhs_code_water", all.x = T, all.y = F)
dhs <- merge(dhs, codebook[,c(7,9)], by.x = "hv213", by.y = "dhs_code_floor", all.x = T, all.y = F)
# putting names, and keep just the required variables
setnames(dhs, "hv002", "hh_nb")
setnames(dhs, "hv001", "cluster_nb")
setnames(dhs, "hv005", "sample_weight")
setnames(dhs, "hv007", "year")
setnames(dhs, "hv025", "urban_rural") # 1 is urban 2 is rural
setnames(dhs, "hv206", "electricity")
setnames(dhs, "hv207", "radio")
setnames(dhs, "hv208", "tv")
setnames(dhs, "hv209", "fridge")
setnames(dhs, "hv211", "motorcycle")
setnames(dhs, "hv212", "car_truck")
setnames(dhs, "hv221", "telephone")
dhs$rooms_per_person <- dhs$hv216/dhs$hv009
dhs$rooms_per_person <- replace(dhs$rooms_per_person, dhs$hv216==99, NA)
dhs <- dhs[,(names(dhs) %in% c("hhid", "hh_nb", "cluster_nb", "sample_weight", "year", "urban_rural", "rooms_per_person", "electricity", "radio", "tv", "fridge", "motorcycle", "car_truck", "telephone", "recode_water", "recode_toilet", "recode_floor"))]
dhs$recode_floor <- as.numeric(dhs$recode_floor)
dhs$recode_water <- as.numeric(dhs$recode_water)
dhs$recode_toilet <- as.numeric(dhs$recode_toilet)
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==1, "urban")
dhs$urban_rural <- replace(dhs$urban_rural, dhs$urban_rural==2, "rural")
summary(dhs)
dhs[dhs==9]=NA
dhs[dhs==99]=NA
write_xlsx(dhs,"mada_dhs_2016_assets_cleaned.xlsx")
rm(codebook, dhs)
codebook <- read_excel("DHS/codebook_dhs_wealthindex_mada.xlsx",1) # first sheet is 1997
dhs <- data.frame(read.dta13("DHS/raw_data/Madagascar/1997/MDHR31FL.DTA", convert.factors = F))
Paths <- c("/Users/juliagirard/Dropbox/LMMA_Madagascar/2.Data/")
codebook <- read_excel("DHS/codebook_dhs_wealthindex_mada.xlsx",1) # first sheet is 1997
Paths <- c("/Users/juliagirard/Dropbox/LMMA_Madagascar/2.Data/DHS/")
codebook <- read_excel("codebook_dhs_wealthindex_mada.xlsx",1) # first sheet is 1997
